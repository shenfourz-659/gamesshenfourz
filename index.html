<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Games Hub - Play Free Online Games</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --dark: #2d3436;
            --light: #f8f9fa;
            --success: #00b894;
            --danger: #e74c3c;
            --warning: #f39c12;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(to right, #6c5ce7, #a29bfe, #fd79a8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        nav {
            display: flex;
            gap: 10px;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        nav a:hover {
            background: rgba(255,255,255,0.1);
            color: var(--secondary);
        }

        /* Main Content */
        main {
            padding: 40px 20px;
            min-height: calc(100vh - 140px);
        }

        .section {
            animation: fadeIn 0.5s ease;
        }

        .hidden {
            display: none !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(135deg, rgba(108, 92, 231, 0.3), rgba(162, 155, 254, 0.1));
            border-radius: 20px;
            margin-bottom: 40px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 25px;
        }

        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(108, 92, 231, 0.4);
        }

        .btn-back {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.2);
            padding: 10px 25px;
            border-radius: 25px;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-back:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: var(--primary);
        }

        /* Games Grid */
        .section-title {
            margin-bottom: 20px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.12);
            border-color: var(--primary);
        }

        .game-icon {
            font-size: 3.5rem;
            margin-bottom: 12px;
            display: block;
        }

        .game-card h3 {
            margin-bottom: 8px;
            font-size: 1.2rem;
        }

        .game-card p {
            opacity: 0.7;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        /* Game Area */
        #gameArea {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }

        #gameArea h2 {
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        #gameArea > p {
            opacity: 0.8;
            margin-bottom: 20px;
        }

        /* Game Controls */
        .game-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .game-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .game-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .game-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .game-info {
            font-size: 1.1rem;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            display: inline-block;
        }

        .game-info span {
            color: var(--secondary);
            font-weight: bold;
        }

        /* Difficulty Buttons */
        .difficulty-btns {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .diff-btn {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 2px solid var(--primary);
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .diff-btn:hover, .diff-btn.active {
            background: var(--primary);
        }

        /* Sudoku */
        .sudoku-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .sudoku-grid {
            display: grid;
            grid-template-columns: repeat(9, 38px);
            background: #333;
            padding: 3px;
            border-radius: 8px;
            gap: 1px;
        }

        .sudoku-cell {
            width: 38px;
            height: 38px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            border: 1px solid #444;
            background: #1a1a2e;
            color: white;
            outline: none;
        }

        .sudoku-cell:focus {
            background: #2d2d5a;
            border-color: var(--primary);
        }

        .sudoku-cell.fixed {
            background: #2d3436;
            color: var(--secondary);
        }

        .sudoku-cell:nth-child(3n) {
            border-right: 2px solid #666;
        }

        .sudoku-cell:nth-child(n+19):nth-child(-n+27),
        .sudoku-cell:nth-child(n+46):nth-child(-n+54) {
            border-bottom: 2px solid #666;
        }

        /* Tic Tac Toe */
        .ttt-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .ttt-grid {
            display: grid;
            grid-template-columns: repeat(3, 90px);
            gap: 8px;
        }

        .ttt-cell {
            width: 90px;
            height: 90px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 10px;
            font-size: 2.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .ttt-cell:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .ttt-cell.winner {
            background: var(--success);
            animation: pulse 0.5s;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Snake */
        .snake-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #snakeCanvas {
            background: #0a0a15;
            border: 3px solid var(--primary);
            border-radius: 10px;
        }

        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 50px);
            gap: 5px;
            margin-top: 15px;
        }

        .mobile-btn {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border: none;
            border-radius: 10px;
            font-size: 1.3rem;
            color: white;
            cursor: pointer;
        }

        .mobile-btn:active {
            background: var(--secondary);
            transform: scale(0.95);
        }

        /* Memory Game */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 70px);
            gap: 10px;
            justify-content: center;
        }

        .memory-card {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 10px;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s;
            color: transparent;
        }

        .memory-card.flipped {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .memory-card.matched {
            background: var(--success);
            color: white;
            cursor: default;
        }

        /* 2048 */
        .game-2048-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .grid-2048 {
            display: grid;
            grid-template-columns: repeat(4, 70px);
            gap: 8px;
            background: #bbada0;
            padding: 8px;
            border-radius: 8px;
        }

        .tile-2048 {
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            font-weight: bold;
            border-radius: 5px;
            background: #cdc1b4;
            color: #776e65;
        }

        /* Minesweeper */
        .mine-grid {
            display: inline-grid;
            grid-template-columns: repeat(10, 32px);
            gap: 2px;
            background: #333;
            padding: 5px;
            border-radius: 8px;
        }

        .mine-cell {
            width: 32px;
            height: 32px;
            background: var(--primary);
            border: none;
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            color: white;
            font-weight: bold;
            transition: background 0.2s;
        }

        .mine-cell:hover {
            background: #7d6ee8;
        }

        .mine-cell.revealed {
            background: #2d3436;
            cursor: default;
        }

        .mine-cell.mine {
            background: var(--danger);
        }

        /* Whack a Mole */
        .mole-grid {
            display: grid;
            grid-template-columns: repeat(3, 90px);
            gap: 12px;
            justify-content: center;
        }

        .mole-hole {
            width: 90px;
            height: 90px;
            background: linear-gradient(180deg, #654321, #3d2817);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            cursor: pointer;
            border: 4px solid #2a1810;
            transition: transform 0.1s;
        }

        .mole-hole:active {
            transform: scale(0.95);
        }

        /* Typing Game */
        .typing-container {
            max-width: 500px;
            margin: 0 auto;
        }

        #typingWord {
            font-size: 2.5rem;
            color: var(--secondary);
            margin: 25px 0;
            letter-spacing: 3px;
            font-weight: bold;
        }

        #typingInput {
            width: 100%;
            max-width: 280px;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid var(--primary);
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            color: white;
            text-align: center;
        }

        #typingInput:focus {
            outline: none;
            border-color: var(--secondary);
        }

        /* Slide Puzzle */
        .puzzle-grid {
            display: grid;
            grid-template-columns: repeat(3, 80px);
            gap: 5px;
            justify-content: center;
            background: #333;
            padding: 5px;
            border-radius: 10px;
        }

        .puzzle-tile {
            width: 80px;
            height: 80px;
            background: var(--primary);
            border: none;
            border-radius: 8px;
            font-size: 1.8rem;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .puzzle-tile:hover {
            background: var(--secondary);
        }

        .puzzle-tile.empty {
            background: transparent;
            cursor: default;
        }

        /* Word Guess */
        .word-display {
            font-size: 2.5rem;
            letter-spacing: 12px;
            margin: 25px 0;
            font-family: monospace;
        }

        .hangman-display {
            font-size: 4rem;
            margin: 15px 0;
        }

        .keyboard-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 6px;
            max-width: 450px;
            margin: 20px auto;
        }

        .key-btn {
            width: 38px;
            height: 42px;
            background: var(--primary);
            border: none;
            border-radius: 5px;
            color: white;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .key-btn:hover:not(:disabled) {
            background: var(--secondary);
        }

        .key-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .key-btn.correct {
            background: var(--success);
        }

        .key-btn.wrong {
            background: var(--danger);
        }

        /* Quiz */
        .quiz-container {
            max-width: 550px;
            margin: 0 auto;
            text-align: left;
        }

        .quiz-question {
            font-size: 1.3rem;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            line-height: 1.5;
        }

        .quiz-option {
            display: block;
            width: 100%;
            padding: 15px 20px;
            margin: 8px 0;
            background: rgba(255,255,255,0.08);
            border: 2px solid transparent;
            border-radius: 10px;
            color: white;
            font-size: 1.05rem;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            background: rgba(255,255,255,0.15);
            border-color: var(--primary);
        }

        .quiz-option.correct {
            background: var(--success);
            border-color: var(--success);
        }

        .quiz-option.wrong {
            background: var(--danger);
            border-color: var(--danger);
        }

        /* Color Match */
        .color-word {
            font-size: 3.5rem;
            font-weight: bold;
            margin: 30px 0;
            padding: 25px;
            border-radius: 15px;
            background: rgba(255,255,255,0.1);
        }

        .color-options {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .color-btn {
            width: 100px;
            height: 50px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            color: white;
        }

        .color-btn:hover {
            transform: scale(1.08);
        }

        /* Tetris */
        .tetris-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        #tetrisCanvas {
            background: #0a0a15;
            border: 3px solid var(--primary);
            border-radius: 8px;
        }

        .tetris-side {
            text-align: center;
        }

        .tetris-next {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        #nextPieceCanvas {
            background: #0a0a15;
            border: 2px solid #444;
            border-radius: 5px;
        }

        /* Mahjong */
        .mahjong-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .mahjong-grid {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            gap: 4px;
            background: #1a5f1a;
            padding: 15px;
            border-radius: 10px;
            border: 3px solid #0d3d0d;
        }

        .mahjong-tile {
            width: 50px;
            height: 60px;
            background: linear-gradient(180deg, #fffff0, #e8e8d0);
            border: 2px solid #888;
            border-radius: 6px;
            font-size: 1.6rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
        }

        .mahjong-tile:hover {
            transform: translateY(-3px);
            box-shadow: 3px 5px 10px rgba(0,0,0,0.4);
        }

        .mahjong-tile.selected {
            border-color: var(--primary);
            box-shadow: 0 0 15px var(--primary);
            transform: translateY(-5px);
        }

        .mahjong-tile.matched {
            opacity: 0;
            pointer-events: none;
        }

        /* Footer */
        footer {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            text-align: center;
            margin-top: 40px;
        }

        footer p {
            opacity: 0.8;
        }

        /* About Section */
        .features-list {
            list-style: none;
            margin-top: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .features-list li {
            background: rgba(255,255,255,0.08);
            padding: 15px;
            border-radius: 10px;
            font-size: 1rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header .container {
                flex-direction: column;
                text-align: center;
            }

            .hero h2 {
                font-size: 1.8rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .mobile-controls {
                display: grid;
            }

            .sudoku-grid {
                grid-template-columns: repeat(9, 32px);
            }

            .sudoku-cell {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }

            .ttt-grid {
                grid-template-columns: repeat(3, 75px);
            }

            .ttt-cell {
                width: 75px;
                height: 75px;
                font-size: 2rem;
            }

            .memory-grid {
                grid-template-columns: repeat(4, 60px);
            }

            .memory-card {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }

            .grid-2048 {
                grid-template-columns: repeat(4, 60px);
            }

            .tile-2048 {
                width: 60px;
                height: 60px;
                font-size: 1.1rem;
            }

            .mahjong-grid {
                grid-template-columns: repeat(6, 45px);
            }

            .mahjong-tile {
                width: 45px;
                height: 55px;
                font-size: 1.3rem;
            }

            .puzzle-grid {
                grid-template-columns: repeat(3, 65px);
            }

            .puzzle-tile {
                width: 65px;
                height: 65px;
                font-size: 1.5rem;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a2e;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">üéÆ Free Games Hub</div>
            <nav>
                <a onclick="showSection('home')">üè† Home</a>
                <a onclick="showSection('games')">üéØ Games</a>
                <a onclick="showSection('about')">‚ÑπÔ∏è About</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Home Section -->
        <section id="home" class="section">
            <div class="hero">
                <h2>üéÆ Welcome to Free Games Hub!</h2>
                <p>Play unlimited free games right in your browser.<br>No downloads, no sign-ups required!</p>
                <button onclick="showSection('games')" class="btn-primary">üéØ Play Now</button>
            </div>
            
            <h3 class="section-title">üî• Popular Games</h3>
            <div class="games-grid" id="popularGames"></div>
        </section>

        <!-- Games Section -->
        <section id="games" class="section hidden">
            <h2 class="section-title">üéÆ All Games</h2>
            <div class="games-grid" id="allGames"></div>
        </section>

        <!-- Game Container -->
        <section id="gameContainer" class="section hidden">
            <button onclick="showSection('games')" class="btn-back">‚Üê Back to Games</button>
            <div id="gameArea"></div>
        </section>

        <!-- About Section -->
        <section id="about" class="section hidden">
            <div class="hero">
                <h2>About Free Games Hub</h2>
                <p>Your ultimate destination for free browser games!</p>
            </div>
            <div style="text-align: center; padding: 20px;">
                <h3>‚ú® Features</h3>
                <ul class="features-list">
                    <li>‚úÖ 100% Free to Play</li>
                    <li>‚úÖ No Downloads Required</li>
                    <li>‚úÖ No Registration Needed</li>
                    <li>‚úÖ Works on All Devices</li>
                    <li>‚úÖ 14 Awesome Games</li>
                    <li>‚úÖ New Games Added Regularly</li>
                </ul>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>üéÆ Free Games Hub ¬© 2024 | Made with ‚ù§Ô∏è | All games are free to play!</p>
        </div>
    </footer>

    <script>
        // ===================== GAME DATA =====================
        const games = [
            { id: 'tetris', name: 'Tetris', icon: 'üß±', description: 'Classic block falling game' },
            { id: 'mahjong', name: 'Mahjong', icon: 'üÄÑ', description: 'Match tiles to clear the board' },
            { id: 'sudoku', name: 'Sudoku', icon: 'üî¢', description: 'Classic number puzzle' },
            { id: 'snake', name: 'Snake', icon: 'üêç', description: 'Eat and grow longer' },
            { id: 'tictactoe', name: 'Tic Tac Toe', icon: '‚≠ï', description: 'Classic X and O game' },
            { id: 'memory', name: 'Memory Match', icon: 'üé¥', description: 'Find matching pairs' },
            { id: 'game2048', name: '2048', icon: 'üéØ', description: 'Merge tiles to reach 2048' },
            { id: 'minesweeper', name: 'Minesweeper', icon: 'üí£', description: 'Avoid the mines' },
            { id: 'whackamole', name: 'Whack a Mole', icon: 'üêπ', description: 'Hit moles for points' },
            { id: 'typing', name: 'Typing Speed', icon: '‚å®Ô∏è', description: 'Test your typing speed' },
            { id: 'puzzle', name: 'Slide Puzzle', icon: 'üß©', description: 'Arrange numbers in order' },
            { id: 'wordguess', name: 'Word Guess', icon: 'üìù', description: 'Guess the hidden word' },
            { id: 'quiz', name: 'Trivia Quiz', icon: 'üß†', description: 'Test your knowledge' },
            { id: 'colormatch', name: 'Color Match', icon: 'üé®', description: 'Match colors quickly' }
        ];

        // ===================== INITIALIZATION =====================
        document.addEventListener('DOMContentLoaded', function() {
            renderGames('popularGames', games.slice(0, 6));
            renderGames('allGames', games);
        });

        // ===================== NAVIGATION =====================
        function showSection(sectionId) {
            clearAllIntervals();
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function clearAllIntervals() {
            if (window.gameInterval) clearInterval(window.gameInterval);
            if (window.gameTimer) clearInterval(window.gameTimer);
            if (window.tetrisInterval) clearInterval(window.tetrisInterval);
        }

        // ===================== RENDER GAMES =====================
        function renderGames(containerId, gamesList) {
            const container = document.getElementById(containerId);
            container.innerHTML = gamesList.map(game => `
                <div class="game-card" onclick="loadGame('${game.id}')">
                    <span class="game-icon">${game.icon}</span>
                    <h3>${game.name}</h3>
                    <p>${game.description}</p>
                </div>
            `).join('');
        }

        // ===================== LOAD GAME =====================
        function loadGame(gameId) {
            clearAllIntervals();
            showSection('gameContainer');
            const gameArea = document.getElementById('gameArea');
            
            const gameLoader = {
                'tetris': initTetris,
                'mahjong': initMahjong,
                'sudoku': initSudoku,
                'snake': initSnake,
                'tictactoe': initTicTacToe,
                'memory': initMemory,
                'game2048': init2048,
                'minesweeper': initMinesweeper,
                'whackamole': initWhackAMole,
                'typing': initTyping,
                'puzzle': initPuzzle,
                'wordguess': initWordGuess,
                'quiz': initQuiz,
                'colormatch': initColorMatch
            };
            
            if (gameLoader[gameId]) {
                gameLoader[gameId](gameArea);
            }
        }

        // ===================== TETRIS =====================
        function initTetris(container) {
            container.innerHTML = `
                <h2>üß± Tetris</h2>
                <p>Use arrow keys to move and rotate. Clear lines to score!</p>
                <div class="tetris-container">
                    <canvas id="tetrisCanvas" width="240" height="400"></canvas>
                    <div class="tetris-side">
                        <div class="tetris-next">
                            <p>Next:</p>
                            <canvas id="nextPieceCanvas" width="80" height="80"></canvas>
                        </div>
                        <p class="game-info">Score: <span id="tetrisScore">0</span></p>
                        <p class="game-info">Lines: <span id="tetrisLines">0</span></p>
                        <p class="game-info">Level: <span id="tetrisLevel">1</span></p>
                    </div>
                </div>
                <div class="mobile-controls" style="display: grid; margin-top: 15px;">
                    <button class="mobile-btn" onclick="tetrisRotate()">üîÑ</button>
                    <button class="mobile-btn" onclick="tetrisMove(-1)">‚¨ÖÔ∏è</button>
                    <button class="mobile-btn" onclick="tetrisMove(1)">‚û°Ô∏è</button>
                    <button class="mobile-btn" onclick="tetrisDrop()">‚¨áÔ∏è</button>
                </div>
                <div class="game-controls">
                    <button class="game-btn" onclick="startTetris()">‚ñ∂Ô∏è Start Game</button>
                </div>
            `;
        }

        const TETRIS_PIECES = [
            [[1,1,1,1]], // I
            [[1,1],[1,1]], // O
            [[0,1,0],[1,1,1]], // T
            [[1,0,0],[1,1,1]], // L
            [[0,0,1],[1,1,1]], // J
            [[0,1,1],[1,1,0]], // S
            [[1,1,0],[0,1,1]]  // Z
        ];

        const TETRIS_COLORS = ['#00f0f0', '#f0f000', '#a000f0', '#f0a000', '#0000f0', '#00f000', '#f00000'];

        function startTetris() {
            const canvas = document.getElementById('tetrisCanvas');
            const ctx = canvas.getContext('2d');
            const nextCanvas = document.getElementById('nextPieceCanvas');
            const nextCtx = nextCanvas.getContext('2d');
            const COLS = 10, ROWS = 20, BLOCK = 24;

            let board = Array(ROWS).fill(null).map(() => Array(COLS).fill(0));
            let score = 0, lines = 0, level = 1;
            let currentPiece, currentX, currentY, currentColor, currentRotation;
            let nextPiece, nextColor;
            let gameOver = false;

            function newPiece() {
                if (nextPiece === undefined) {
                    const idx = Math.floor(Math.random() * TETRIS_PIECES.length);
                    nextPiece = TETRIS_PIECES[idx];
                    nextColor = TETRIS_COLORS[idx];
                }
                currentPiece = nextPiece;
                currentColor = nextColor;
                currentRotation = 0;
                currentX = Math.floor(COLS / 2) - Math.floor(currentPiece[0].length / 2);
                currentY = 0;
                
                const idx = Math.floor(Math.random() * TETRIS_PIECES.length);
                nextPiece = TETRIS_PIECES[idx];
                nextColor = TETRIS_COLORS[idx];
                
                drawNext();
                
                if (collision()) {
                    gameOver = true;
                    clearInterval(window.tetrisInterval);
                    alert('Game Over! Score: ' + score);
                }
            }

            function drawNext() {
                nextCtx.fillStyle = '#0a0a15';
                nextCtx.fillRect(0, 0, 80, 80);
                const offsetX = (80 - nextPiece[0].length * 18) / 2;
                const offsetY = (80 - nextPiece.length * 18) / 2;
                nextPiece.forEach((row, y) => {
                    row.forEach((val, x) => {
                        if (val) {
                            nextCtx.fillStyle = nextColor;
                            nextCtx.fillRect(offsetX + x * 18, offsetY + y * 18, 16, 16);
                        }
                    });
                });
            }

            function collision(testX = currentX, testY = currentY, testPiece = currentPiece) {
                for (let y = 0; y < testPiece.length; y++) {
                    for (let x = 0; x < testPiece[y].length; x++) {
                        if (testPiece[y][x]) {
                            const newX = testX + x;
                            const newY = testY + y;
                            if (newX < 0 || newX >= COLS || newY >= ROWS) return true;
                            if (newY >= 0 && board[newY][newX]) return true;
                        }
                    }
                }
                return false;
            }

            function merge() {
                currentPiece.forEach((row, y) => {
                    row.forEach((val, x) => {
                        if (val && currentY + y >= 0) {
                            board[currentY + y][currentX + x] = currentColor;
                        }
                    });
                });
            }

            function clearLines() {
                let cleared = 0;
                for (let y = ROWS - 1; y >= 0; y--) {
                    if (board[y].every(cell => cell !== 0)) {
                        board.splice(y, 1);
                        board.unshift(Array(COLS).fill(0));
                        cleared++;
                        y++;
                    }
                }
                if (cleared > 0) {
                    lines += cleared;
                    score += [0, 100, 300, 500, 800][cleared] * level;
                    level = Math.floor(lines / 10) + 1;
                    document.getElementById('tetrisScore').textContent = score;
                    document.getElementById('tetrisLines').textContent = lines;
                    document.getElementById('tetrisLevel').textContent = level;
                }
            }

            function rotate() {
                const rotated = currentPiece[0].map((_, i) => 
                    currentPiece.map(row => row[i]).reverse()
                );
                if (!collision(currentX, currentY, rotated)) {
                    currentPiece = rotated;
                }
            }

            function draw() {
                ctx.fillStyle = '#0a0a15';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw grid
                ctx.strokeStyle = '#1a1a2e';
                for (let x = 0; x <= COLS; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * BLOCK, 0);
                    ctx.lineTo(x * BLOCK, ROWS * BLOCK);
                    ctx.stroke();
                }
                for (let y = 0; y <= ROWS; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * BLOCK);
                    ctx.lineTo(COLS * BLOCK, y * BLOCK);
                    ctx.stroke();
                }
                
                // Draw board
                board.forEach((row, y) => {
                    row.forEach((color, x) => {
                        if (color) {
                            ctx.fillStyle = color;
                            ctx.fillRect(x * BLOCK + 1, y * BLOCK + 1, BLOCK - 2, BLOCK - 2);
                        }
                    });
                });
                
                // Draw current piece
                if (currentPiece) {
                    ctx.fillStyle = currentColor;
                    currentPiece.forEach((row, y) => {
                        row.forEach((val, x) => {
                            if (val) {
                                ctx.fillRect(
                                    (currentX + x) * BLOCK + 1,
                                    (currentY + y) * BLOCK + 1,
                                    BLOCK - 2, BLOCK - 2
                                );
                            }
                        });
                    });
                }
            }

            function drop() {
                if (gameOver) return;
                currentY++;
                if (collision()) {
                    currentY--;
                    merge();
                    clearLines();
                    newPiece();
                }
                draw();
            }

            window.tetrisMove = function(dir) {
                if (gameOver) return;
                currentX += dir;
                if (collision()) currentX -= dir;
                draw();
            };

            window.tetrisRotate = function() {
                if (gameOver) return;
                rotate();
                draw();
            };

            window.tetrisDrop = function() {
                if (gameOver) return;
                while (!collision()) currentY++;
                currentY--;
                merge();
                clearLines();
                newPiece();
                draw();
            };

            document.onkeydown = function(e) {
                if (gameOver) return;
                switch(e.key) {
                    case 'ArrowLeft': window.tetrisMove(-1); e.preventDefault(); break;
                    case 'ArrowRight': window.tetrisMove(1); e.preventDefault(); break;
                    case 'ArrowUp': window.tetrisRotate(); e.preventDefault(); break;
                    case 'ArrowDown': drop(); e.preventDefault(); break;
                    case ' ': window.tetrisDrop(); e.preventDefault(); break;
                }
            };

            clearInterval(window.tetrisInterval);
            newPiece();
            draw();
            window.tetrisInterval = setInterval(drop, Math.max(100, 500 - level * 40));
        }

        // ===================== MAHJONG =====================
        function initMahjong(container) {
            const tiles = ['üÄá','üÄà','üÄâ','üÄä','üÄã','üÄå','üÄç','üÄé','üÄè',
                          'üÄê','üÄë','üÄí','üÄì','üÄî','üÄï','üÄñ','üÄó','üÄò',
                          'üÄô','üÄö','üÄõ','üÄú','üÄù','üÄû','üÄü','üÄ†','üÄ°',
                          'üÄÄ','üÄÅ','üÄÇ','üÄÉ','üÄÑ','üÄÖ','üÄÜ'];
            
            // Select 18 pairs (36 tiles for 6x6 grid or adjust)
            const selectedTiles = [];
            const useTiles = tiles.slice(0, 18);
            useTiles.forEach(t => { selectedTiles.push(t, t); });
            
            // Shuffle
            for (let i = selectedTiles.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [selectedTiles[i], selectedTiles[j]] = [selectedTiles[j], selectedTiles[i]];
            }

            window.mahjongState = {
                tiles: selectedTiles,
                selected: null,
                matched: new Set(),
                moves: 0,
                pairs: 0
            };

            container.innerHTML = `
                <h2>üÄÑ Mahjong</h2>
                <p>Match identical tiles to clear the board</p>
                <p class="game-info">Pairs: <span id="mahjongPairs">0</span>/18 | Moves: <span id="mahjongMoves">0</span></p>
                <div class="mahjong-container">
                    <div class="mahjong-grid" id="mahjongGrid"></div>
                </div>
                <div class="game-controls">
                    <button class="game-btn" onclick="initMahjong(document.getElementById('gameArea'))">üîÑ New Game</button>
                </div>
            `;

            renderMahjong();
        }

        function renderMahjong() {
            const grid = document.getElementById('mahjongGrid');
            const state = window.mahjongState;
            
            grid.innerHTML = state.tiles.map((tile, i) => `
                <button class="mahjong-tile ${state.matched.has(i) ? 'matched' : ''} ${state.selected === i ? 'selected' : ''}" 
                        onclick="selectMahjongTile(${i})" ${state.matched.has(i) ? 'disabled' : ''}>
                    ${tile}
                </button>
            `).join('');
        }

        function selectMahjongTile(index) {
            const state = window.mahjongState;
            
            if (state.matched.has(index)) return;
            
            if (state.selected === null) {
                state.selected = index;
                renderMahjong();
            } else if (state.selected === index) {
                state.selected = null;
                renderMahjong();
            } else {
                state.moves++;
                document.getElementById('mahjongMoves').textContent = state.moves;
                
                if (state.tiles[state.selected] === state.tiles[index]) {
                    state.matched.add(state.selected);
                    state.matched.add(index);
                    state.pairs++;
                    document.getElementById('mahjongPairs').textContent = state.pairs;
                    
                    if (state.pairs === 18) {
                        setTimeout(() => alert('üéâ Congratulations! You won in ' + state.moves + ' moves!'), 300);
                    }
                }
                state.selected = null;
                renderMahjong();
            }
        }

        // ===================== SUDOKU =====================
        const sudokuPuzzles = [
            {
                puzzle: [5,3,0,0,7,0,0,0,0,6,0,0,1,9,5,0,0,0,0,9,8,0,0,0,0,6,0,8,0,0,0,6,0,0,0,3,4,0,0,8,0,3,0,0,1,7,0,0,0,2,0,0,0,6,0,6,0,0,0,0,2,8,0,0,0,0,4,1,9,0,0,5,0,0,0,0,8,0,0,7,9],
                solution: [5,3,4,6,7,8,9,1,2,6,7,2,1,9,5,3,4,8,1,9,8,3,4,2,5,6,7,8,5,9,7,6,1,4,2,3,4,2,6,8,5,3,7,9,1,7,1,3,9,2,4,8,5,6,9,6,1,5,3,7,2,8,4,2,8,7,4,1,9,6,3,5,3,4,5,2,8,6,1,7,9]
            }
        ];

        function initSudoku(container) {
            const puzzleData = sudokuPuzzles[0];
            window.sudokuPuzzle = [...puzzleData.puzzle];
            window.sudokuSolution = puzzleData.solution;

            container.innerHTML = `
                <h2>üî¢ Sudoku</h2>
                <p>Fill the grid so every row, column, and 3√ó3 box contains 1-9</p>
                <div class="sudoku-container">
                    <div class="sudoku-grid" id="sudokuGrid"></div>
                    <div class="game-controls">
                        <button class="game-btn" onclick="checkSudoku()">‚úì Check</button>
                        <button class="game-btn" onclick="solveSudoku()">üí° Solve</button>
                        <button class="game-btn" onclick="initSudoku(document.getElementById('gameArea'))">üîÑ Reset</button>
                    </div>
                    <p id="sudokuMsg" class="game-info" style="min-height: 20px;"></p>
                </div>
            `;

            const grid = document.getElementById('sudokuGrid');
            for (let i = 0; i < 81; i++) {
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'sudoku-cell' + (window.sudokuPuzzle[i] !== 0 ? ' fixed' : '');
                input.maxLength = 1;
                input.value = window.sudokuPuzzle[i] || '';
                input.readOnly = window.sudokuPuzzle[i] !== 0;
                input.oninput = function() { this.value = this.value.replace(/[^1-9]/g, ''); };
                grid.appendChild(input);
            }
        }

        function checkSudoku() {
            const cells = document.querySelectorAll('.sudoku-cell');
            let correct = true, incomplete = false;
            
            cells.forEach((cell, i) => {
                if (!cell.value) incomplete = true;
                else if (parseInt(cell.value) !== window.sudokuSolution[i]) {
                    correct = false;
                    cell.style.color = '#e74c3c';
                } else {
                    cell.style.color = cell.classList.contains('fixed') ? '#a29bfe' : '#00b894';
                }
            });
            
            const msg = document.getElementById('sudokuMsg');
            if (incomplete) { msg.textContent = '‚ö†Ô∏è Fill all cells!'; msg.style.color = '#f39c12'; }
            else if (correct) { msg.textContent = 'üéâ Correct!'; msg.style.color = '#00b894'; }
            else { msg.textContent = '‚ùå Some errors found'; msg.style.color = '#e74c3c'; }
        }

        function solveSudoku() {
            const cells = document.querySelectorAll('.sudoku-cell');
            cells.forEach((cell, i) => {
                cell.value = window.sudokuSolution[i];
                cell.style.color = cell.classList.contains('fixed') ? '#a29bfe' : '#00b894';
            });
            document.getElementById('sudokuMsg').textContent = 'üí° Solved!';
        }

        // ===================== SNAKE =====================
        function initSnake(container) {
            container.innerHTML = `
                <h2>üêç Snake</h2>
                <p>Use arrow keys or buttons to move. Eat food to grow!</p>
                <p class="game-info">Score: <span id="snakeScore">0</span></p>
                <div class="snake-container">
                    <canvas id="snakeCanvas" width="320" height="320"></canvas>
                    <div class="mobile-controls">
                        <div></div>
                        <button class="mobile-btn" onclick="setSnakeDir(0,-1)">‚¨ÜÔ∏è</button>
                        <div></div>
                        <button class="mobile-btn" onclick="setSnakeDir(-1,0)">‚¨ÖÔ∏è</button>
                        <button class="mobile-btn" onclick="setSnakeDir(0,1)">‚¨áÔ∏è</button>
                        <button class="mobile-btn" onclick="setSnakeDir(1,0)">‚û°Ô∏è</button>
                    </div>
                </div>
                <div class="game-controls">
                    <button class="game-btn" onclick="startSnake()">‚ñ∂Ô∏è Start</button>
                </div>
            `;
        }

        function setSnakeDir(x, y) {
            if (!window.snakeGame) return;
            const size = 16;
            if (x !== 0 && window.snakeGame.dx === 0) {
                window.snakeGame.dx = x * size;
                window.snakeGame.dy = 0;
            } else if (y !== 0 && window.snakeGame.dy === 0) {
                window.snakeGame.dy = y * size;
                window.snakeGame.dx = 0;
            }
        }

        function startSnake() {
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            const size = 16, cols = 20, rows = 20;

            window.snakeGame = {
                snake: [{x: 160, y: 160}],
                food: null,
                dx: size, dy: 0,
                score: 0,
                running: true
            };
            const game = window.snakeGame;

            function spawnFood() {
                let food;
                do {
                    food = {
                        x: Math.floor(Math.random() * cols) * size,
                        y: Math.floor(Math.random() * rows) * size
                    };
                } while (game.snake.some(s => s.x === food.x && s.y === food.y));
                return food;
            }

            game.food = spawnFood();

            function draw() {
                ctx.fillStyle = '#0a0a15';
                ctx.fillRect(0, 0, 320, 320);

                ctx.fillStyle = '#e74c3c';
                ctx.beginPath();
                ctx.arc(game.food.x + size/2, game.food.y + size/2, size/2 - 2, 0, Math.PI * 2);
                ctx.fill();

                game.snake.forEach((seg, i) => {
                    ctx.fillStyle = i === 0 ? '#00b894' : '#55efc4';
                    ctx.fillRect(seg.x + 1, seg.y + 1, size - 2, size - 2);
                });
            }

            function update() {
                if (!game.running) return;
                const head = {x: game.snake[0].x + game.dx, y: game.snake[0].y + game.dy};

                if (head.x < 0 || head.x >= 320 || head.y < 0 || head.y >= 320 ||
                    game.snake.some(s => s.x === head.x && s.y === head.y)) {
                    game.running = false;
                    clearInterval(window.gameInterval);
                    alert('Game Over! Score: ' + game.score);
                    return;
                }

                game.snake.unshift(head);
                if (head.x === game.food.x && head.y === game.food.y) {
                    game.score++;
                    document.getElementById('snakeScore').textContent = game.score;
                    game.food = spawnFood();
                } else {
                    game.snake.pop();
                }
                draw();
            }

            document.onkeydown = function(e) {
                switch(e.key) {
                    case 'ArrowUp': case 'w': setSnakeDir(0, -1); break;
                    case 'ArrowDown': case 's': setSnakeDir(0, 1); break;
                    case 'ArrowLeft': case 'a': setSnakeDir(-1, 0); break;
                    case 'ArrowRight': case 'd': setSnakeDir(1, 0); break;
                }
            };

            clearInterval(window.gameInterval);
            window.gameInterval = setInterval(update, 100);
            draw();
        }

        // ===================== TIC TAC TOE =====================
        function initTicTacToe(container) {
            window.ttt = { board: Array(9).fill(''), current: 'X', over: false };
            
            container.innerHTML = `
                <h2>‚≠ï Tic Tac Toe</h2>
                <p class="game-info">Player <span id="tttPlayer">‚ùå</span>'s turn</p>
                <div class="ttt-container">
                    <div class="ttt-grid" id="tttGrid"></div>
                </div>
                <div class="game-controls">
                    <button class="game-btn" onclick="initTicTacToe(document.getElementById('gameArea'))">üîÑ New Game</button>
                </div>
            `;

            const grid = document.getElementById('tttGrid');
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('button');
                cell.className = 'ttt-cell';
                cell.onclick = () => tttMove(i);
                grid.appendChild(cell);
            }
        }

        function tttMove(i) {
            const t = window.ttt;
            if (t.board[i] || t.over) return;
            
            t.board[i] = t.current;
            document.querySelectorAll('.ttt-cell')[i].textContent = t.current === 'X' ? '‚ùå' : '‚≠ï';
            
            const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
            for (let [a,b,c] of wins) {
                if (t.board[a] && t.board[a] === t.board[b] && t.board[a] === t.board[c]) {
                    t.over = true;
                    [a,b,c].forEach(x => document.querySelectorAll('.ttt-cell')[x].classList.add('winner'));
                    document.getElementById('tttPlayer').parentElement.innerHTML = `üéâ ${t.current === 'X' ? '‚ùå' : '‚≠ï'} Wins!`;
                    return;
                }
            }
            
            if (!t.board.includes('')) {
                t.over = true;
                document.getElementById('tttPlayer').parentElement.innerHTML = "ü§ù It's a Draw!";
                return;
            }
            
            t.current = t.current === 'X' ? 'O' : 'X';
            document.getElementById('tttPlayer').textContent = t.current === 'X' ? '‚ùå' : '‚≠ï';
        }

        // ===================== MEMORY =====================
        function initMemory(container) {
            const emojis = ['üéÆ','üé≤','üéØ','üé™','üé®','üé≠','üé¨','üé§'];
            const cards = [...emojis, ...emojis].sort(() => Math.random() - 0.5);
            
            window.memory = { cards, flipped: [], matched: [], moves: 0, canFlip: true };

            container.innerHTML = `
                <h2>üé¥ Memory Match</h2>
                <p class="game-info">Moves: <span id="memMoves">0</span> | Pairs: <span id="memPairs">0</span>/8</p>
                <div class="memory-grid" id="memGrid"></div>
                <div class="game-controls">
                    <button class="game-btn" onclick="initMemory(document.getElementById('gameArea'))">üîÑ New Game</button>
                </div>
            `;

            const grid = document.getElementById('memGrid');
            cards.forEach((emoji, i) => {
                const card = document.createElement('button');
                card.className = 'memory-card';
                card.dataset.emoji = emoji;
                card.onclick = () => flipMemoryCard(i);
                grid.appendChild(card);
            });
        }

        function flipMemoryCard(i) {
            const m = window.memory;
            if (!m.canFlip || m.flipped.includes(i) || m.matched.includes(i)) return;
            
            const cards = document.querySelectorAll('.memory-card');
            cards[i].textContent = m.cards[i];
            cards[i].classList.add('flipped');
            m.flipped.push(i);
            
            if (m.flipped.length === 2) {
                m.moves++;
                m.canFlip = false;
                document.getElementById('memMoves').textContent = m.moves;
                
                const [a, b] = m.flipped;
                if (m.cards[a] === m.cards[b]) {
                    m.matched.push(a, b);
                    cards[a].classList.add('matched');
                    cards[b].classList.add('matched');
                    m.flipped = [];
                    m.canFlip = true;
                    document.getElementById('memPairs').textContent = m.matched.length / 2;
                    
                    if (m.matched.length === 16) {
                        setTimeout(() => alert('üéâ Won in ' + m.moves + ' moves!'), 300);
                    }
                } else {
                    setTimeout(() => {
                        cards[a].textContent = '';
                        cards[b].textContent = '';
                        cards[a].classList.remove('flipped');
                        cards[b].classList.remove('flipped');
                        m.flipped = [];
                        m.canFlip = true;
                    }, 800);
                }
            }
        }

        // ===================== 2048 =====================
        function init2048(container) {
            window.g2048 = { grid: Array(16).fill(0), score: 0 };
            addTile2048(); addTile2048();

            container.innerHTML = `
                <h2>üéØ 2048</h2>
                <p class="game-info">Score: <span id="score2048">0</span></p>
                <div class="game-2048-container">
                    <div class="grid-2048" id="grid2048"></div>
                </div>
                <div class="mobile-controls" style="display: grid; margin-top: 15px;">
                    <div></div>
                    <button class="mobile-btn" onclick="move2048('up')">‚¨ÜÔ∏è</button>
                    <div></div>
                    <button class="mobile-btn" onclick="move2048('left')">‚¨ÖÔ∏è</button>
                    <button class="mobile-btn" onclick="move2048('down')">‚¨áÔ∏è</button>
                    <button class="mobile-btn" onclick="move2048('right')">‚û°Ô∏è</button>
                </div>
                <div class="game-controls">
                    <button class="game-btn" onclick="init2048(document.getElementById('gameArea'))">üîÑ New Game</button>
                </div>
            `;

            render2048();
            document.onkeydown = function(e) {
                const keyMap = { ArrowUp: 'up', ArrowDown: 'down', ArrowLeft: 'left', ArrowRight: 'right' };
                if (keyMap[e.key]) { e.preventDefault(); move2048(keyMap[e.key]); }
            };
        }

        function addTile2048() {
            const empty = window.g2048.grid.map((v, i) => v === 0 ? i : -1).filter(i => i >= 0);
            if (empty.length) {
                window.g2048.grid[empty[Math.floor(Math.random() * empty.length)]] = Math.random() < 0.9 ? 2 : 4;
            }
        }

        function render2048() {
            const colors = {0:'#cdc1b4',2:'#eee4da',4:'#ede0c8',8:'#f2b179',16:'#f59563',32:'#f67c5f',64:'#f65e3b',128:'#edcf72',256:'#edcc61',512:'#edc850',1024:'#edc53f',2048:'#edc22e'};
            document.getElementById('grid2048').innerHTML = window.g2048.grid.map(v => 
                `<div class="tile-2048" style="background:${colors[v]||'#3c3a32'};color:${v>4?'#f9f6f2':'#776e65'}">${v||''}</div>`
            ).join('');
        }

        function move2048(dir) {
            const g = window.g2048.grid;
            const old = JSON.stringify(g);
            
            function slide(arr) {
                let a = arr.filter(v => v);
                for (let i = 0; i < a.length - 1; i++) {
                    if (a[i] === a[i+1]) { a[i] *= 2; window.g2048.score += a[i]; a.splice(i+1, 1); }
                }
                while (a.length < 4) a.push(0);
                return a;
            }
            
            for (let i = 0; i < 4; i++) {
                let line;
                if (dir === 'left') line = [g[i*4], g[i*4+1], g[i*4+2], g[i*4+3]];
                else if (dir === 'right') line = [g[i*4+3], g[i*4+2], g[i*4+1], g[i*4]];
                else if (dir === 'up') line = [g[i], g[i+4], g[i+8], g[i+12]];
                else line = [g[i+12], g[i+8], g[i+4], g[i]];
                
                line = slide(line);
                if (dir === 'right' || dir === 'down') line.reverse();
                
                if (dir === 'left' || dir === 'right') {
                    [g[i*4], g[i*4+1], g[i*4+2], g[i*4+3]] = line;
                } else {
                    [g[i], g[i+4], g[i+8], g[i+12]] = line;
                }
            }
            
            if (JSON.stringify(g) !== old) {
                addTile2048();
                document.getElementById('score2048').textContent = window.g2048.score;
            }
            render2048();
        }

        // ===================== MINESWEEPER =====================
        function initMinesweeper(container) {
            const size = 10, mines = 15;
            window.mine = {
                grid: Array(100).fill(0),
                revealed: Array(100).fill(false),
                flags: Array(100).fill(false),
                over: false
            };
            
            let placed = 0;
            while (placed < mines) {
                const i = Math.floor(Math.random() * 100);
                if (window.mine.grid[i] !== -1) { window.mine.grid[i] = -1; placed++; }
            }
            
            for (let i = 0; i < 100; i++) {
                if (window.mine.grid[i] === -1) continue;
                let count = 0;
                getNeighbors(i).forEach(n => { if (window.mine.grid[n] === -1) count++; });
                window.mine.grid[i] = count;
            }

            container.innerHTML = `
                <h2>üí£ Minesweeper</h2>
                <p class="game-info">üí£ ${mines} mines | Right-click to flag</p>
                <div class="mine-grid" id="mineGrid"></div>
                <div class="game-controls">
                    <button class="game-btn" onclick="initMinesweeper(document.getElementById('gameArea'))">üîÑ New Game</button>
                </div>
            `;

            const grid = document.getElementById('mineGrid');
            for (let i = 0; i < 100; i++) {
                const cell = document.createElement('button');
                cell.className = 'mine-cell';
                cell.onclick = () => revealMine(i);
                cell.oncontextmenu = (e) => { e.preventDefault(); flagMine(i); };
                grid.appendChild(cell);
            }
        }

        function getNeighbors(i) {
            const n = [], r = Math.floor(i / 10), c = i % 10;
            for (let dr = -1; dr <= 1; dr++) {
                for (let dc = -1; dc <= 1; dc++) {
                    if (dr === 0 && dc === 0) continue;
                    const nr = r + dr, nc = c + dc;
                    if (nr >= 0 && nr < 10 && nc >= 0 && nc < 10) n.push(nr * 10 + nc);
                }
            }
            return n;
        }

        function revealMine(i) {
            const m = window.mine;
            if (m.over || m.revealed[i] || m.flags[i]) return;
            
            const cells = document.querySelectorAll('.mine-cell');
            m.revealed[i] = true;
            cells[i].classList.add('revealed');
            
            if (m.grid[i] === -1) {
                cells[i].textContent = 'üí£';
                cells[i].classList.add('mine');
                m.over = true;
                m.grid.forEach((v, j) => { if (v === -1) { cells[j].textContent = 'üí£'; cells[j].classList.add('revealed', 'mine'); } });
                setTimeout(() => alert('üí• Game Over!'), 100);
                return;
            }
            
            const colors = ['','#3498db','#27ae60','#e74c3c','#9b59b6','#f39c12','#1abc9c','#34495e','#2c3e50'];
            if (m.grid[i] > 0) {
                cells[i].textContent = m.grid[i];
                cells[i].style.color = colors[m.grid[i]];
            } else {
                getNeighbors(i).forEach(n => revealMine(n));
            }
            
            if (m.revealed.filter((r, j) => !r && m.grid[j] !== -1).length === 0) {
                m.over = true;
                setTimeout(() => alert('üéâ You won!'), 100);
            }
        }

        function flagMine(i) {
            const m = window.mine;
            if (m.over || m.revealed[i]) return;
            m.flags[i] = !m.flags[i];
            document.querySelectorAll('.mine-cell')[i].textContent = m.flags[i] ? 'üö©' : '';
        }

        // ===================== WHACK A MOLE =====================
        function initWhackAMole(container) {
            container.innerHTML = `
                <h2>üêπ Whack a Mole</h2>
                <p class="game-info">Score: <span id="moleScore">0</span> | Time: <span id="moleTime">30</span>s</p>
                <div class="mole-grid" id="moleGrid"></div>
                <div class="game-controls">
                    <button class="game-btn" onclick="startMole()">‚ñ∂Ô∏è Start</button>
                </div>
            `;

            const grid = document.getElementById('moleGrid');
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.className = 'mole-hole';
                hole.onclick = () => whackMole(i);
                grid.appendChild(hole);
            }
        }

        function startMole() {
            window.mole = { score: 0, time: 30, active: -1 };
            document.getElementById('moleScore').textContent = '0';
            document.getElementById('moleTime').textContent = '30';
            
            clearInterval(window.gameInterval);
            clearInterval(window.gameTimer);
            
            window.gameInterval = setInterval(() => {
                const holes = document.querySelectorAll('.mole-hole');
                holes.forEach(h => h.textContent = '');
                window.mole.active = Math.floor(Math.random() * 9);
                holes[window.mole.active].textContent = 'üêπ';
            }, 700);
            
            window.gameTimer = setInterval(() => {
                window.mole.time--;
                document.getElementById('moleTime').textContent = window.mole.time;
                if (window.mole.time <= 0) {
                    clearInterval(window.gameInterval);
                    clearInterval(window.gameTimer);
                    document.querySelectorAll('.mole-hole').forEach(h => h.textContent = '');
                    alert('‚è∞ Time up! Score: ' + window.mole.score);
                }
            }, 1000);
        }

        function whackMole(i) {
            if (i === window.mole.active && window.mole.time > 0) {
                window.mole.score++;
                document.getElementById('moleScore').textContent = window.mole.score;
                document.querySelectorAll('.mole-hole')[i].textContent = 'üí•';
                window.mole.active = -1;
            }
        }

        // ===================== TYPING =====================
        function initTyping(container) {
            window.typeWords = ['javascript','programming','keyboard','computer','developer','algorithm','database','interface','function','variable'];
            
            container.innerHTML = `
                <h2>‚å®Ô∏è Typing Speed</h2>
                <div class="typing-container">
                    <p class="game-info">WPM: <span id="typeWPM">0</span> | Words: <span id="typeCount">0</span> | Time: <span id="typeTime">60</span>s</p>
                    <p id="typingWord"></p>
                    <input type="text" id="typingInput" placeholder="Type here..." disabled autocomplete="off">
                </div>
                <div class="game-controls">
                    <button class="game-btn" onclick="startTyping()">‚ñ∂Ô∏è Start</button>
                </div>
            `;
        }

        function startTyping() {
            window.typing = { score: 0, time: 60, start: Date.now() };
            const input = document.getElementById('typingInput');
            input.disabled = false;
            input.value = '';
            input.focus();
            
            showTypeWord();
            
            input.oninput = function() {
                if (input.value.toLowerCase().trim() === window.currentTypeWord) {
                    window.typing.score++;
                    document.getElementById('typeCount').textContent = window.typing.score;
                    input.value = '';
                    showTypeWord();
                    const wpm = Math.round(window.typing.score / ((Date.now() - window.typing.start) / 60000));
                    document.getElementById('typeWPM').textContent = wpm;
                }
            };
            
            clearInterval(window.gameTimer);
            window.gameTimer = setInterval(() => {
                window.typing.time--;
                document.getElementById('typeTime').textContent = window.typing.time;
                if (window.typing.time <= 0) {
                    clearInterval(window.gameTimer);
                    input.disabled = true;
                    alert('‚è∞ Done! WPM: ' + document.getElementById('typeWPM').textContent);
                }
            }, 1000);
        }

        function showTypeWord() {
            window.currentTypeWord = window.typeWords[Math.floor(Math.random() * window.typeWords.length)];
            document.getElementById('typingWord').textContent = window.currentTypeWord;
        }

        // ===================== SLIDE PUZZLE =====================
        function initPuzzle(container) {
            window.puzzle = { tiles: [1,2,3,4,5,6,7,8,0], moves: 0 };
            
            for (let i = 0; i < 100; i++) {
                const empty = window.puzzle.tiles.indexOf(0);
                const moves = getPuzzleMoves(empty);
                const m = moves[Math.floor(Math.random() * moves.length)];
                [window.puzzle.tiles[empty], window.puzzle.tiles[m]] = [window.puzzle.tiles[m], window.puzzle.tiles[empty]];
            }

            container.innerHTML = `
                <h2>üß© Slide Puzzle</h2>
                <p class="game-info">Moves: <span id="puzzleMoves">0</span></p>
                <div class="puzzle-grid" id="puzzleGrid"></div>
                <div class="game-controls">
                    <button class="game-btn" onclick="initPuzzle(document.getElementById('gameArea'))">üîÑ New Game</button>
                </div>
            `;
            renderPuzzle();
        }

        function getPuzzleMoves(i) {
            const m = [], r = Math.floor(i / 3), c = i % 3;
            if (r > 0) m.push(i - 3);
            if (r < 2) m.push(i + 3);
            if (c > 0) m.push(i - 1);
            if (c < 2) m.push(i + 1);
            return m;
        }

        function renderPuzzle() {
            document.getElementById('puzzleGrid').innerHTML = window.puzzle.tiles.map((t, i) => 
                `<button class="puzzle-tile ${t === 0 ? 'empty' : ''}" onclick="movePuzzle(${i})">${t || ''}</button>`
            ).join('');
        }

        function movePuzzle(i) {
            const empty = window.puzzle.tiles.indexOf(0);
            if (getPuzzleMoves(empty).includes(i)) {
                [window.puzzle.tiles[empty], window.puzzle.tiles[i]] = [window.puzzle.tiles[i], window.puzzle.tiles[empty]];
                window.puzzle.moves++;
                document.getElementById('puzzleMoves').textContent = window.puzzle.moves;
                renderPuzzle();
                if (JSON.stringify(window.puzzle.tiles) === JSON.stringify([1,2,3,4,5,6,7,8,0])) {
                    setTimeout(() => alert('üéâ Solved in ' + window.puzzle.moves + ' moves!'), 100);
                }
            }
        }

        // ===================== WORD GUESS =====================
        function initWordGuess(container) {
            const words = ['JAVASCRIPT','PYTHON','COMPUTER','PROGRAMMING','DEVELOPER','KEYBOARD','INTERNET','SOFTWARE'];
            window.word = {
                secret: words[Math.floor(Math.random() * words.length)],
                guessed: [],
                wrong: 0,
                max: 6
            };

            container.innerHTML = `
                <h2>üìù Word Guess</h2>
                <div class="hangman-display" id="hangman">üòÄ</div>
                <p class="game-info">Wrong: <span id="wrongCount">0</span>/6</p>
                <p class="word-display" id="wordDisplay">${'_ '.repeat(window.word.secret.length)}</p>
                <div class="keyboard-grid" id="keyboard"></div>
                <div class="game-controls">
                    <button class="game-btn" onclick="initWordGuess(document.getElementById('gameArea'))">üîÑ New Word</button>
                </div>
            `;

            const kb = document.getElementById('keyboard');
            'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').forEach(l => {
                const btn = document.createElement('button');
                btn.className = 'key-btn';
                btn.textContent = l;
                btn.onclick = () => guessLetter(l, btn);
                kb.appendChild(btn);
            });
        }

        function guessLetter(l, btn) {
            const w = window.word;
            if (w.guessed.includes(l)) return;
            w.guessed.push(l);
            btn.disabled = true;

            const faces = ['üòÄ','üòê','üòü','üò®','üò∞','üò±','üíÄ'];

            if (w.secret.includes(l)) {
                btn.classList.add('correct');
                const display = w.secret.split('').map(c => w.guessed.includes(c) ? c : '_').join(' ');
                document.getElementById('wordDisplay').textContent = display;
                if (!display.includes('_')) {
                    setTimeout(() => alert('üéâ You won!'), 100);
                }
            } else {
                btn.classList.add('wrong');
                w.wrong++;
                document.getElementById('wrongCount').textContent = w.wrong;
                document.getElementById('hangman').textContent = faces[w.wrong];
                if (w.wrong >= w.max) {
                    document.querySelectorAll('.key-btn').forEach(b => b.disabled = true);
                    document.getElementById('wordDisplay').textContent = w.secret.split('').join(' ');
                    setTimeout(() => alert('üíÄ Game Over! Word: ' + w.secret), 100);
                }
            }
        }

        // ===================== QUIZ =====================
        function initQuiz(container) {
            window.quiz = {
                questions: [
                    { q: "What is the capital of France?", o: ["London","Berlin","Paris","Madrid"], a: 2 },
                    { q: "Which planet is the Red Planet?", o: ["Venus","Mars","Jupiter","Saturn"], a: 1 },
                    { q: "What is 15 √ó 8?", o: ["100","120","130","115"], a: 1 },
                    { q: "Who painted the Mona Lisa?", o: ["Van Gogh","Picasso","Da Vinci","Monet"], a: 2 },
                    { q: "What is the largest ocean?", o: ["Atlantic","Indian","Arctic","Pacific"], a: 3 },
                    { q: "How many continents are there?", o: ["5","6","7","8"], a: 2 },
                    { q: "What year did World War II end?", o: ["1943","1944","1945","1946"], a: 2 },
                    { q: "What is H2O?", o: ["Salt","Water","Sugar","Oil"], a: 1 },
                    { q: "Largest mammal?", o: ["Elephant","Blue Whale","Giraffe","Hippo"], a: 1 },
                    { q: "Square root of 144?", o: ["10","11","12","13"], a: 2 }
                ].sort(() => Math.random() - 0.5),
                index: 0,
                score: 0
            };

            container.innerHTML = `
                <h2>üß† Trivia Quiz</h2>
                <p class="game-info">Question: <span id="quizNum">1</span>/10 | Score: <span id="quizScore">0</span></p>
                <div class="quiz-container" id="quizContainer"></div>
            `;
            showQuizQuestion();
        }

        function showQuizQuestion() {
            const q = window.quiz;
            if (q.index >= 10) {
                document.getElementById('quizContainer').innerHTML = `
                    <h3>üéâ Quiz Complete!</h3>
                    <p style="font-size: 2rem; color: var(--secondary);">${q.score}/10</p>
                    <button class="game-btn" onclick="initQuiz(document.getElementById('gameArea'))">üîÑ Play Again</button>
                `;
                return;
            }

            const question = q.questions[q.index];
            document.getElementById('quizNum').textContent = q.index + 1;
            document.getElementById('quizContainer').innerHTML = `
                <p class="quiz-question">${question.q}</p>
                ${question.o.map((opt, i) => `<button class="quiz-option" onclick="answerQuiz(${i})">${opt}</button>`).join('')}
            `;
        }

        function answerQuiz(i) {
            const q = window.quiz;
            const correct = q.questions[q.index].a;
            const btns = document.querySelectorAll('.quiz-option');
            
            btns.forEach((b, j) => {
                b.style.pointerEvents = 'none';
                b.classList.add(j === correct ? 'correct' : (j === i ? 'wrong' : ''));
            });
            
            if (i === correct) {
                q.score++;
                document.getElementById('quizScore').textContent = q.score;
            }
            
            q.index++;
            setTimeout(showQuizQuestion, 1200);
        }

        // ===================== COLOR MATCH =====================
        function initColorMatch(container) {
            container.innerHTML = `
                <h2>üé® Color Match</h2>
                <p class="game-info">Score: <span id="colorScore">0</span> | Time: <span id="colorTime">30</span>s</p>
                <p>Click the button matching the TEXT COLOR, not the word!</p>
                <div class="color-word" id="colorWord">Ready?</div>
                <div class="color-options" id="colorOptions"></div>
                <div class="game-controls">
                    <button class="game-btn" onclick="startColor()">‚ñ∂Ô∏è Start</button>
                </div>
            `;
        }

        function startColor() {
            window.color = { score: 0, time: 30, active: true };
            document.getElementById('colorScore').textContent = '0';
            document.getElementById('colorTime').textContent = '30';
            
            showColorChallenge();
            
            clearInterval(window.gameTimer);
            window.gameTimer = setInterval(() => {
                window.color.time--;
                document.getElementById('colorTime').textContent = window.color.time;
                if (window.color.time <= 0) {
                    clearInterval(window.gameTimer);
                    window.color.active = false;
                    document.getElementById('colorWord').textContent = 'TIME UP!';
                    document.getElementById('colorWord').style.color = 'white';
                    document.getElementById('colorOptions').innerHTML = '';
                    alert('‚è∞ Score: ' + window.color.score);
                }
            }, 1000);
        }

        function showColorChallenge() {
            if (!window.color.active) return;
            
            const colors = [
                { n: 'RED', h: '#e74c3c' },
                { n: 'BLUE', h: '#3498db' },
                { n: 'GREEN', h: '#27ae60' },
                { n: 'YELLOW', h: '#f1c40f' },
                { n: 'PURPLE', h: '#9b59b6' },
                { n: 'ORANGE', h: '#e67e22' }
            ];
            
            const wordColor = colors[Math.floor(Math.random() * colors.length)];
            let textColor;
            do { textColor = colors[Math.floor(Math.random() * colors.length)]; } 
            while (textColor.n === wordColor.n && Math.random() > 0.3);
            
            window.correctColor = textColor.n;
            
            document.getElementById('colorWord').textContent = wordColor.n;
            document.getElementById('colorWord').style.color = textColor.h;
            
            const opts = [...colors].sort(() => Math.random() - 0.5).slice(0, 4);
            if (!opts.find(c => c.n === textColor.n)) {
                opts[0] = textColor;
                opts.sort(() => Math.random() - 0.5);
            }
            
            document.getElementById('colorOptions').innerHTML = opts.map(c => 
                `<button class="color-btn" style="background:${c.h}" onclick="checkColor('${c.n}')">${c.n}</button>`
            ).join('');
        }

        function checkColor(n) {
            if (!window.color.active) return;
            if (n === window.correctColor) {
                window.color.score++;
                document.getElementById('colorScore').textContent = window.color.score;
            }
            showColorChallenge();
        }

        // Start on home
        showSection('home');
    </script>
</body>
</html>